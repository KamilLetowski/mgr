\chapter{Algorytmy zach³anne - Przemys³aw}
	Istnieje wiele algorytmów zach³annych pozwalaj¹cych otrzymaæ optymalne rozwi¹zanie dla problemu znalezienia najkrótszej trasy. W poni¿szym rozdziale opisane dok³adniej zosta³o dzia³anie algorytmu najbli¿szego s¹siada, algorytmu najmniejszej krawêdzi oraz algorytmu A*. W celu zoptymalizowania otrzymanych rozwi¹zañ zastosowany zostanie operator 2-opt oraz wspó³czynnik b³êdu przy dokonywaniu wyborów.

\section{Algorytm najbli¿szego s¹siada}
	Poni¿szy podrozdzia³ przybli¿y dzia³anie algorytmu najbli¿szego s¹siada. Wszystkie wymagane dla algorytmu operacje zostan¹ opisane krok po kroku oraz przedstawione na krótkim przyk³adzie. Jak sama nazwa wskazuje jest to algorytm polegaj¹cy na odwiedzaniu, zaczynaj¹c od wybranego wierzcho³ka pocz¹tkowego nastêpnego wierzcho³ka jeszcze nieodwiedzonego znajduj¹cego siê najbli¿ej poprzednio odwiedzonego. 

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.5]{grafika/ans_graph.png}
	\caption{Schemat algorytmu najbli¿szego s¹siada}
	\label{nearest_neighbour}
\end{figure}

Na rysunku \ref{nearest_neighbour} zosta³ pokazany schemat blokowy algorytmu najbli¿szego s¹siada. Pierwszym krokiem jest wyznaczenie wyznaczenie wierzcho³ka startowego. Nastêpnie dla aktualnego wierzcho³ka nale¿y obliczyæ najkrótsz¹ krawêdŸ ³¹cz¹c¹ aktualny wierzcho³ek spoœród kolekcji wierzcho³ków nieodwiedzonych. Wybór najlepszej opcji po³¹czenia dwóch wierzcho³ków nale¿y dodaæ do rozwi¹zania, a drugi wierzcho³ek staje siê aktualnym od którego bêdziemy wyznaczaæ kolejne odleg³oœci do nieodwiedzonych jeszcze wierzcho³ków. Czynnoœci nale¿y powtarzaæ do momentu odwiedzenia wszystkich wierzcho³ków w podanym grafie. Na samym koñcu wystarczy jedynie po³¹czyæ ostatni wierzcho³ek z pocz¹tkowym. Po wykonaniu wszystkich kroków algorytm najbli¿szego s¹siada powinien zwróciæ optymalne dla niego rozwi¹zanie.

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.3]{grafika/ans_last.png}
	\caption{Algorytm najbli¿szego s¹siada}
	\label{nearest_neighbour_inaction}
\end{figure}

	Aby lepiej zobrazowaæ otrzymanie rozwi¹zania przez algorytm przedstawiono poni¿ej na rysunku \ref{nearest_neighbour_inaction} jego dzia³anie na przyk³adzie. W podanym przypadku nale¿y za³o¿yæ ¿e wierzcho³ek nr 2 jest wierzcho³kiem startowym, wiêc nale¿y ustawiæ go jako aktualny w danym momencie. Po obliczeniu wszystkich odleg³oœci prowadzonych do wierzcho³ków nieodwiedzonych wychodzi, ¿e najkrótsza krawêdŸ prowadzi do wierzcho³ka nr 4, wiêc nale¿y do³¹czyæ wybrana krawêdŸ do rozwi¹zania i oznaczyæ nowy aktualny wierzcho³ek, który staje siê równie¿ odwiedzonym. W podanym grafie znajduj¹ siê nadal nieodwiedzone wierzcho³ki, dlatego algorytm powtarza krok nr 2 w celu znalezienia kolejnej najkrótszej krawêdzi. Kolejn¹ najlepsz¹ odnalezion¹ w danym momencie krawêdzi¹, któr¹ algorytm doda do rozwi¹zania bêdzie krawêdŸ o wartoœci 3 ³¹cz¹ca aktualny wierzcho³ek z wierzcho³kiem nr 5. Kroki 4, 5 oraz 6 przedstawiaj¹ kolejne powtarzalne iteracje algorytmu dochodz¹c w ostatnim kroku do utworzenia cyklu i tym zakoñczeniu dzia³ania algorytmu. W ten sposób otrzymano zach³anne rozwi¹zanie 2 - 4 - 5 - 3 - 1 - 2. Warto zaznaczyæ, ¿e dziêki oznaczaniu wierzcho³ków jako odwiedzone nie trzeba w ¿adnej iteracji martwiæ siê o to czy do³¹czenie kolejnej krawêdzi z nieodwiedzonym wierzcho³kiem spowoduje utworzenie niepo¿¹danego cyklu.

\section{Algorytm najmniejszej krawêdzi}
	Kolejny podrozdzia³ algorytmów zach³annych zosta³ poœwiêcony dok³adniejszemu opisie dzia³ania algorytmu najmniejszej krawêdzi, który w swoim dzia³aniu przypomina algorytm poszukuj¹cy minimalnego drzewa rozpinaj¹cego, poprzez do³¹czenie do aktualnego rozwi¹zania najkrótszych wœród dopuszczalnych krawêdzi.	Aby otrzymaæ zach³anne rozwi¹zanie przy wykorzystaniu algorytmu najmniejszej krawêdzi nale¿y wykonaæ nastêpuj¹ce kroki przedstawione schemacie blokowym na rysunku \ref{ank}.
	
\begin{figure}[h]
	\centering
	\includegraphics[scale=0.4]{grafika/ank_graph.png}
	\caption{Schemat algorytmu najmniejszej krawêdzi}
	\label{ank}
\end{figure}

Algorytm rozpoczyna swoje dzia³anie od posortowania wag krawêdzi miêdzy wszystkimi wierzcho³kami oraz umieszcza podane odleg³oœci w kolekcji. Nastêpnie wybierana jest zawsze krawêdŸ o najmniejsze wartoœci oraz od razu usuwana jest z podanej kolekcji. Aby wybrane po³¹czenie miêdzy wierzcho³kami zosta³o dodane do rozwi¹zania musi spe³niaæ warunek nie utworzenia cyklu oraz wierzcho³ka o trzech krawêdziach, w przeciwnym wypadku po³¹czenie jest pomijane oraz algorytm wybiera kolejn¹ krawêdŸ. Iteracje s¹ powtarzane do momentu, a¿ liczba dodanych po³¹czeñ jest równa liczbie wszystkich wierzcho³ków. W przypadku ostatniej iteracji wyznaczona krawêdŸ nie musi ju¿ spe³niaæ warunku z utworzeniem cyklu. Po zakoñczeniu dzia³ania algorytmu otrzymano optymalne rozwi¹zanie dla algorytmu najmniejszej krawêdzi.
	
\begin{figure}[h]
	\centering
	\includegraphics[scale=0.5]{grafika/ank_initial_finish.png}
	\caption{Pocz¹tkowe rozmieszczenie wierzcho³ków}
	\label{ank_initial}
\end{figure}

Dzia³anie algorytmu przedstawione zosta³o na rysunku \ref{ank_initial} przedstawiaj¹cym przyk³ad ze szeœcioma losowo rozmieszczonymi wierzcho³kami. Natomiast wizualizacja kolejnych kroków algorytmu zosta³a przedstawiona na rysunku \ref{ank_final}. Po posortowaniu wszystkich dostêpnych krawêdzi dla ka¿dego wierzcho³ka mo¿na rozpocz¹æ dzia³anie algorytmu.
	
\begin{figure}[h]
	\centering
	\includegraphics[scale=0.30]{grafika/ank_steps_final.png}
	\caption{Algorytm najmniejszej krawêdzi}
	\label{ank_final}
\end{figure}

	Podczas pierwszej iteracji okazuje siê, ¿e s¹ aktualnie dwie krawêdzie z najmniejsz¹ wag¹ o wartoœci 3 (1 - 2 oraz 4 - 5), nie ma wiêc znaczenia, która krawêdŸ algorytm doda w pierwszej kolejnoœci, poniewa¿ ¿adna z wybranych nie utworzy w tym momencie cyklu. W przypadku drugiej iteracji algorytm wybiera krawêdŸ o najmniejszej wadze, do³¹czaj¹c j¹ do aktualnego rozwi¹zania. Analogiczna sytuacja do pierwszej iteracji wystêpuje w trzeciej iteracji, gdzie nie ma ró¿nicy, która krawêdŸ zostanie do³¹czona do rozwi¹zania. Czwarta iteracja pokazuje sytuacje, w której nie mo¿na po³¹czyæ krawêdzi 3 - 4, poniewa¿ utworzy³oby to niedozwolony w trakcie algorytmu cykl, dlatego tym razem wybierane jest inne po³¹czenie o najmniejszej wadze (4 - 6). Kolejny krok przedstawia przedstawia przypadek, gdzie nie jest mo¿liwe po³¹czenie krawêdzi 2 - 4 (najmniejsza wartoœæ - 7), poniewa¿ spowodowa³oby dla wierzcho³ka nr 4 utworzenie trzech wychodz¹cych z niego krawêdzi, wiêc do rozwi¹zania dochodzi kolejna najmniejsza krawêdŸ 1 - 6. W ostatnim kroku, pomimo dostêpnych krawêdzi z mniejsz¹ wag¹ wybierana zosta³a krawêdŸ 2 - 3, poniewa¿ tylko ona nie spowoduje utworzenia wierzcho³ka o trzech krawêdziach. W takim wypadku koñcz¹c dzia³anie algorytmu otrzymano rozwi¹zanie 1 - 6 - 4 - 5 - 3 - 2 - 1.
	
\section{Algorytm A*}
	Ostatnim omówionym rozwi¹zaniem do znajdowania najkrótszej œcie¿ki w grafie jest algorytm A*, w którym zawsze zostanie znalezione najkorzystniejsze zach³anne rozwi¹zanie. Strategia gwarantuje, ¿e ka¿dy wierzcho³ek zostanie odwiedzony, przy czym dokonuje w danym momencie najlepszych wyborów. G³ówn¹ zasad¹ algorytmu A* jest minimalizacja funkcji kosztu $g(x)$ oraz funkcji heurystycznej $h(x)$ zdefiniowanej jako funkcja celu $f(x)=g(x)+h(x)$. Funkcja heurystyczna musi spe³niaæ dwa wymagane warunki tj. warunek dopuszczalnoœci i warunek monotonicznoœci. Warunek dopuszczalnoœci polega na tym, aby funkcja heurystyczna za bardzo minimalizowa³a koszt, a przesadza³a przy maksymalizacji zysku. Natomiast warunek monotonicznoœci mówi, ¿e oszacowywanie wyniku musi byæ coraz mniej optymistyczne w momencie zbli¿ania siê do rozwi¹zania. Jeœli przestrzeñ przeszukiwañ zawieraæ bêdzie œcie¿ki to mo¿na wówczas sprowadziæ problem do problemu poszukiwania najkrótszej œcie¿ki w grafie. W danym przypadku funkcj¹ heurystyczn¹ bêdzie wówczas odleg³oœæ w linii prostej miêdzy wierzcho³kami. Zapewnia to w ten sposób, ¿e taka funkcja jest nadmiernie optymistyczna.
	
\begin{figure}[h]
	\centering
	\includegraphics[scale=0.4]{grafika/astar_schema.png}
	\caption{Schemat blokowy algorytmu A*}
	\label{astar_schema}
\end{figure}	
	
Schemat blokowy dzia³ania algorytmu A* zosta³ przedstawiony na rysunku \ref{astar_schema}. Algorytm rozpoczyna swoje dzia³anie od wyboru wierzcho³ka startowego oraz koñcowego, gdzie wierzcho³ek startowy staje siê aktualnym. Nastêpnie dla aktualnego wierzcho³ka obliczana i zapisywana jest funkcja celu $f(x)$ dla ka¿dego poszczególnego mo¿liwego po³¹czenia. Kolejnym krokiem jest wybranie spoœród minimalnej funkcji celu dla aktualnego wierzcho³ka oraz minimalnej funkcji celu z poprzednio zapisanych (jeœli takowe istniej¹). Jeœli wybrana funkcja celu nie ³¹czy aktualnego wierzcho³ka z docelowym oraz nie utworzy cyklu lub wierzcho³ka o trzech krawêdziach jest brana dalej pod uwagê i ustalany jest nowy aktualny wierzcho³ek. W przeciwnym wypadku wybrana funkcja celu nie jest brana pod uwagê i algorytm jeszcze raz porównuje obliczone poprzednio funkcje celu. Kroki algorytmu s¹ powtarzane do momentu a¿ wybrana funkcja celu po³¹czy aktualny wierzcho³ek z koñcowym.


\begin{figure}[h]
	\centering
	\includegraphics[scale=0.4]{grafika/astar_initial.png}
	\caption{Graf u¿yty do przedstawienia dzia³ania algorytmu A*}
	\label{astar_initial}
\end{figure}

Lepsza wizualizacja dzia³ania algorytmu A* zosta³a przedstawiona na grafie umieszczonym na rysunku \ref{astar_initial}. Wierzcho³kiem startowym bêdzie w tym wypadku wierzcho³ek numer 1, natomiast wierzcho³kiem docelowym bêdzie punkt numer 7. Jak mo¿na zauwa¿yc na rysunku \ref{astar_final} podczas pierwszej iteracji algorytm A* zdefiniowa³ dwie funkcje celu, jednak¿e $f1(2)=4+5$ jest w danym momencie lepszym wyborem. W kolejnej iteracji nadal rozwiniêcie pierwszej funkcji celu daje lepszy rezultat, dlatego te¿ nowym aktualnym wierzcho³kiem staje siê wierzcho³ek numer 3. Trzecia iteracja przedstawia sytuacje, w której druga funkcja celu ³¹cz¹ca aktualny wierzcho³ek z wierzcho³kiem numer 5 daje lepszy w danym momencie rezultat, dlatego wierzcho³ek numer 5 jest brany pod uwagê. Po zastosowaniu siê do za³o¿eñ algorytmu oraz wykonaniu wszystkich kroków otrzymujemy optymalne rozwi¹zanie ³¹cz¹ce wierzcho³ek numer 1 z wierzcho³kiem numer 7(1 - 5 - 6 - 7) o wartoœci 21.


\begin{figure}[h]
	\centering
	\includegraphics[scale=0.2]{grafika/astar_final.png}
	\caption{Poszczególne iteracje algorytmu A*}
	\label{astar_final}
\end{figure}



\section{Optymalizacja otrzymanych rozwi¹zañ}
	W ostatnim podrozdziale skupimy siê na sposobach optymalizacji otrzymanych przez algorytmy zach³anne rozwi¹zañ. Dok³adniej omówiona zostanie metoda 2-opt oraz zastosowanie wspó³czynnika b³êdu zaproponowanego przez studenta.
	
\subsection{Metoda 2-opt}
	Metoda optymalizacyjna 2-opt polega na pozbyciu siê z cyklu dwóch krawêdzi w celu zast¹pienia ich innymi krawêdziami w taki sposób, aby otworzyæ zupe³nie inny cykl. Iteracje mo¿na powtarzaæ dla ka¿dej pary krawêdzi, oprócz tych s¹siaduj¹cych ze sob¹, poniewa¿ ich zamienienie nie przynios³oby ¿adnej modyfikacji. Metoda nie ma na celu zmiany po³o¿enia wierzcho³ków, jedynie kolejnoœci ich odwiedzania. Po wykonaniu ca³ej optymalizacji, nale¿y sprawdziæ która modyfikacja przynios³a najlepszy efekt skrócenia d³ugoœci cyklu. W przypadku je¿eli ¿adna modyfikacja nie da³a lepszego rozwi¹zania, nie nale¿y modyfikowaæ rozwi¹zania. Algorytm mo¿na wykonywaæ wielokrotnie, w ten sposób zostanie zrealizowane minimum lokalne. Dla lepszego przedstawienia dzia³ania metody 2-opt, nale¿y spojrzeæ na rysunek 5.4.

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.7]{grafika/2opt.png}
	\caption{Metoda 2-opt}
	\label{2opt}
\end{figure}	

\subsection{Propozycje optymalizacji}
	Aby rozwa¿yæ wiêcej tras zwracanych przez algorytmy zach³anne zaproponowano u¿ycie wspó³czynnika b³êdu przy dokonywaniu przez algorytm w danym momencie najlepszego dla niego wyboru. Wspó³czynnik dzia³a na zasadzie brania pod uwagê gorszego wyboru, aby zwiêkszyæ liczbê przegl¹danych odcinków. Ma to na celu mo¿liwoœæ znalezienia lepszego rozwi¹zania ni¿ takiego jakie zwróci³by sam algorytm. Wspó³czynnik b³êdu mo¿e byæ uruchamiany na ka¿dym etapie budowania docelowej trasy. Zastosowanie wspó³czynnika b³êdu mo¿e podnieœæ z³o¿onoœæ algorytmu nawet do $\theta$(\(n^n\)), gdzie $n$ jest równe liczbie wierzcho³ku. St¹d propozycj¹ jest stosowanie wspó³czynnika b³êdu tylko na wybranych trzech etapach budowania koñcowej trasy.
